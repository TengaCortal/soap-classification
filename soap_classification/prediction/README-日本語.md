# SOAPセクション予測

このフォルダには、医療記録内のSOAPセクションの自動分類を目的とした一連の予測モデルが含まれています。現在、実装されている主要な予測モデルは、TF-IDFに基づいています。

## 1. TF-IDF

TF-IDF（Term Frequency-Inverse Document Frequency）は、情報検索やテキストマイニングで使用される数値統計量であり、文書内の単語の重要性を文書コーパス（複数の文書集合）に対して評価するために使用されます。

主要な2つの要素で構成されています：TF & IDF

### 1-1. Term Frequency（TF）：

文書内での用語（単語）の頻度を測定します。
文書内での用語の出現回数を文書内の総用語数で割ることで計算されます。

TF(t, d) = （文書 d 中の用語 t の出現回数） / （文書 d 内の総用語数）

### 1-2. Inverse Document Frequency（IDF）

コーパス全体の文書間での用語の希少性を測定します。

コーパス内の文書総数を用語を含む文書の数で割った対数を取り、ゼロ除算を避けるために1を加算して計算されます。

IDF(t) = log_e（コーパス内の文書総数 / 用語 t を含む文書数）

### 1-3. TF-IDF スコア

文書内の用語のTF-IDFスコアは、そのTFとIDFスコアを掛け合わせることで得られます：
TF-IDF(t, d) = TF(t, d) * IDF(t)

TF-IDFは、文書内で頻出だがコーパス内では希少な用語を強調し、より情報豊かで識別力のある用語に重みを与えます。これは、テキスト分類、情報検索、ドキュメントクラスタリングなどのさまざまな自然言語処理タスクで一般的に使用されています。

### 1-4. TF-IDF分類器の実装

プロセスを段階的に解説しましょう：

1. **入力**: TF-IDF分類器への入力は、分割されたSOAPノートのリストです。各SOAPノートは、最初に「。」を区切り文字として使用してセクションに分割されます。

2. **予測**: 分類器は、各SOAPノート内の各分割に対してセクションのラベルを予測します。たとえば、SOAPノートが3つの分割を持つ場合、分類器はそれぞれの分割に対してラベルを予測します。

3. **すべてのラベル（S、O、A、P）を確認**: 予測後、分割されたSOAPノートのいずれかにすべての4つのラベル（S、O、A、P）が含まれていない場合、初期の分割が効果的ではない可能性があります。

4. **再分割**: そのような場合、システムは分割されたSOAPノート内の最長の分割を特定します。そして、この最長の分割を「 」（スペース）を区切り文字として再分割します。このステップは、最長の分割をより包括的なセクションにキャプチャするために、最長の分割をより小さな単位に分割することを目的としています。

5. **新しい分割の予測**: 再分割の後、分類器は新しく形成された分割のセクションラベルを予測します。

6. **予測の更新**: 最後に、再分割後に行われた予測に基づいて予測されたラベルが更新されます。これらの更新されたラベルは、SOAPノート内の分割の以前の予測を置き換えます。